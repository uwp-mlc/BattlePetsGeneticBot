/**
 * 
 */
package edu.furbiesfighters.presenters;



import java.io.IOException;
import java.util.List;

import edu.furbiesfighters.gameplay.Main;
import edu.furbiesfighters.gameplay.Referee;
import edu.furbiesfighters.players.Playable;
import edu.furbiesfighters.views.PreBattleView;
import javafx.collections.FXCollections;

/**
 * @author Furbies Fighters
 *
 */
public class PreBattlePresenter {
	private Main mainApp;
	private PreBattleView view;
	private Referee ref;
	
	public PreBattlePresenter(PreBattleView view)
	{
		this.view = view;
	}
	
	public void setReferee(Referee ref)
	{
		this.ref = ref;
	}
	
	/**
	 * Handle initialization of all view elements 
	 */
	public void initializeView()
	{
		String playerList = "";
		List <Playable> list= this.ref.getAllPlayables();
		for(int i = 0; i < list.size(); i++)
		{
			 playerList += "Player " + i + ": "+ 
					 list.get(i).getPlayerName() + " " + list.get(i).getPetName() + ".\n";
		}
		this.view.getTxtPlayerList().setText(playerList);	
		this.view.getTxtPlayerList().setEditable(false);
	}
	
	
	public void setMainApp(Main mainApp)
	{
		this.mainApp = mainApp;
	}
	

	
	/**
	 * Starts the fight
	 */
	public void startButtonClicked()
	{
		try
		{
			if(startGame(Integer.parseInt(this.view.getTxtFightNumber().getText())))
			{
				this.view.getTxtFightNumber().setText("");
			}
		}
		catch(NumberFormatException e)
		{
			this.view.getTxtFightNumber().setText("");
		}
	}
	
	public boolean startGame(int fightNumber)
	{
		return fightNumber > 0;
	}
	
	//Lucas and Connor added
	public void changeViewToGamePlay()
	{
		try {
			this.mainApp.showGamePlayView(this.ref);
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
